Map: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51760/51760 [00:23<00:00, 2205.84 examples/s]
labels[0][:40]: tensor([  101,  2917,  2003,  2019,  7899,  2008,  5577,  1037,  4708,  1010,
        12739,  2007,  2019,  7953,  2008,  3640,  2582,  6123,  1012,  4339,
         1037,  3433,  2008, 23263, 28123,  1996,  5227,  1012,  1001,  1001,
         1001,  7899,  1024,  5646,  1996, 17060,  2005,  2023,  2622,  2011])
unique labels: tensor([    0,   101,   102,  1001,  1005,  1010,  1012,  1015,  1016,  1017,
         1018,  1019,  1020,  1024,  1029,  1037,  1045,  1055,  1523,  1524,
         1996,  1997,  1998,  1999,  2000,  2001,  2002,  2003,  2004,  2005,
         2006,  2007,  2008,  2009,  2010,  2011,  2013,  2018,  2019,  2020,
         2023,  2029,  2030,  2034,  2036,  2045,  2046,  2051,  2076,  2084,
         2086,  2088,  2097,  2117,  2119,  2124,  2126,  2127,  2130,  2154,
         2162,  2164,  2169,  2184,  2193,  2202,  2211,  2244,  2251,  2281,
         2295,  2307,  2321,  2322,  2340,  2381,  2385,  2403,  2420,  2437,
         2443,  2454,  2458,  2462,  2510,  2529,  2558,  2561,  2582,  2622,
         2635,  2654,  2706,  2707,  2753,  2757,  2847,  2917,  2936,  3020,
         3155,  3160,  3223,  3365,  3386,  3408,  3433,  3548,  3615,  3640,
         3912,  3926,  3963,  4041,  4076,  4102,  4175,  4269,  4271,  4339,
         4340,  4346,  4358,  4403,  4542,  4554,  4708,  4736,  4975,  5073,
         5227,  5478,  5577,  5587,  5604,  5646,  6022,  6123,  6251,  6354,
         6677,  7655,  7899,  7953,  9272,  9367,  9510, 10813, 10938, 11075,
        12654, 12739, 12826, 15314, 17060, 19844, 21292, 23263, 28123])
ignore_index in CE: -100
Traceback (most recent call last):
  File "/orcd/home/002/hyewona/lr-act/current_models/baseline_model_v2.py", line 293, in <module>
    main()
    ~~~~^^
  File "/orcd/home/002/hyewona/lr-act/current_models/baseline_model_v2.py", line 226, in main
    debug_loss = ce_loss(logits.view(B * S, V), labels.view(-1))
                 ^^^^^^^
UnboundLocalError: cannot access local variable 'ce_loss' where it is not associated with a value
